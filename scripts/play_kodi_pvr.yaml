alias: Enciende la caja tonta
sequence:
  - alias: Play TV channel
    service: media_player.play_media
    data_template:
      entity_id: media_player.kodi
#      The type of the content to play. Must be one of MUSIC, TVSHOW, VIDEO, EPISODE, CHANNEL or PLAYLIST
      media_content_type: "CHANNEL"
      media_content_id: >
        {% if (now().hour < 14) or ((now().hour == 14) and (now().minute < 50)) %}
          10
        {% elif (now().hour < 16) %}
          15
        {% elif (now().hour < 20) %}
          2
        {% elif (now().hour == 20) and (now().minute < 50) %}
          10
        {% elif (now().hour == 20) or ((now().hour == 21) and (now().minute < 15)) %}
          15
        {% else %}
          10
        {% endif %}

  - alias: Notificación de selección de canal
    service: notify.telegram_bot
    data_template:
      title: '*TV PVR ON*'
      target: !secret telegram_bot_chat_id_admin
      message: >
        Encendido de caja tonta en canal '{% if (now().hour < 14) or ((now().hour == 14) and (now().minute < 50)) %}laSexta HD{% elif (now().hour < 16) %}antena3 HD{% elif (now().hour < 20) %}24h{% elif (now().hour == 20) and (now().minute < 50) %}laSexta HD{% elif (now().hour == 20) or ((now().hour == 21) and (now().minute < 15)) %}antena3 HD{% else %}laSexta HD{% endif %}'.

      data:
        disable_notification: true

#curl -s --user osmc:osmc --header "Content-Type: application/json" --data-binary '{"id": 1, "params": {"channelgroupid": 1}, "jsonrpc": "2.0", "method": "PVR.GetChannels"}' http://192.168.1.56:8080/jsonrpc
#  {"id":1,
#  "jsonrpc":"2.0",
#  "result":{"channels":[
#    {"channelid":12,"label":"La 1 HD."},
#    {"channelid":1,"label":"La 2"},
#    {"channelid":15,"label":"antena3 HD"},
#    {"channelid":13,"label":"Cuatro HD"},
#    {"channelid":6,"label":"Telecinco HD"},
#    {"channelid":10,"label":"laSexta HD"},
#    {"channelid":2,"label":"24h"},
#    {"channelid":4,"label":"Intercomarcal TV"},
#    {"channelid":3,"label":"neox"},
#    {"channelid":14,"label":"atreseries HD"},
#    {"channelid":11,"label":"FDF"},
#    {"channelid":8,"label":"Disney Channel"},
#    {"channelid":5,"label":"PARAMOUNT CHANNEL"},
#    {"channelid":7,"label":"nova"},
#    {"channelid":16,"label":"Divinity"},
#    {"channelid":9,"label":"Clan"}
#    ],"limits":{"end":16,"start":0,"total":16}}}

#curl -s --user osmc:osmc --header "Content-Type: application/json" --data-binary '{"id": 1, "params": {"channelid": 15}, "jsonrpc": "2.0", "method": "PVR.GetChannelDetails"}' http://192.168.1.56:8080/jsonrpc
#curl -s --user osmc:osmc --header "Content-Type: application/json" --data-binary '{"id": 1, "params": {"channelid": 15}, "jsonrpc": "2.0", "method": "PVR.GetBroadcasts"}' http://192.168.1.56:8080/jsonrpc
#{ "jsonrpc": "2.0", "method": "Player.Open", "params": { "item": { "channelid": 10}}, "id":1}
#media_player/play_media
#
#{"entity_id": "media_player.kodi",
#"media_content_id": 10,
#"media_content_type": "CHANNEL"}
